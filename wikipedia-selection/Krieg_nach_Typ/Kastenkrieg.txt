Der so genannte Kastenkrieg (spanisch Guerra de Castas) war ein zeitweise erfolgreicher, letztlich aber gescheiterter Unabhängigkeitskrieg der Maya-Bevölkerung auf der Halbinsel Yucatán in den Jahren 1847 bis 1901, der formell mit der Einnahme des letzten unabhängigen Maya-Stützpunktes Chan Santa Cruz durch mexikanische Truppen endete.Die Maya-Landbevölkerung befand sich auch nach der Unabhängigkeit der Republiken Lateinamerikas in einer Situation härtester Ausbeutung durch die allein regierende weiße Oberschicht (Abgaben, Zwangsarbeit, Ausweitung des weißen Großgrundbesitzes durch Konfiskation des Landbesitzes der indigenen Einwohner und aller unerschlossenen Gebiete), die zu einer Verschärfung der ökonomischen Situation und so zu einer verstärkten Unruhe unter den Indigenen führte. Ebenso wenig wie mit dem unabhängigen Mexiko konnten sich die Mayas mit den Weißen Yucatans, den Yucatecos, und der von ihnen ausgerufenen Republik Yucatán identifizieren.Auslöser für die erste Revolte am 30. Juli 1847 in Tepich im heutigen Quintana Roo, etwa 50 km westlich von Valladolid, war die Hinrichtung des Maya-Führers Manuel Antonio Hay (oder Ay) sowie zweier weiterer Maya-Persönlichkeiten. Der Aufstand dehnte sich zunächst auf Tihosuco und dann auf den ganzen Osten Yucatans, später auf die gesamte Halbinsel aus. 1848 hatten die Mayas praktisch die ganze Halbinsel unter ihrer Kontrolle bis auf die von ihnen belagerten Städte Mérida, Campeche und einige dazwischen liegende Städte. Vor diesem Hintergrund, als gleichzeitig der Krieg zwischen den USA und Mexiko tobte, bot die Regierung von Yucatán den USA, Großbritannien und Spanien die Aufgabe seiner Souveränität an unter der Maßgabe, dass die entsprechende Kolonialmacht die Maya-Kämpfer vernichten würde. Nach dem Friedensschluss zwischen den USA und Mexiko stimmte Yucatán schließlich dem Wiederanschluss an Mexiko zu, der am 17. August 1848 erfolgte.
Es bleibt ungeklärt, warum die Maya nicht die günstige Situation nutzten und die letzten Stützpunkte der Weißen stürmten. Bekannt ist, dass ein Großteil der Maya-Kämpfer, die gleichzeitig Bauern waren, die Kampflinien für die Aussaat verließ. Angenommen wird, dass die Maya-Führer Jacinto Pat und Cecilio Chí kein Interesse an den Städten der Weißen hatten und den Kampf als ausschließlichen Verteidigungskrieg auffassten. Es wird auch die Fähigkeit der schlecht bewaffneten und ausgebildeten Maya-Kämpfer angezweifelt, Städte überhaupt erobern zu können.

Nach der Wiedervereinigung mit Mexiko 1848 schickte dieses Truppen nach Yucatán, die einen Großteil der Halbinsel recht schnell wieder unterwarfen. 
Der Gouverneur von Yucatán, Miguel Barbachano, verkaufte 1849 auf eigene Initiative einmal 140 und dann ein zweites Mal 195 gefangene Maya als Sklaven nach Kuba, das damals noch spanische Kolonie war. Dabei verstieß er gegen geltendes Recht der Republik Mexiko, die im Gegensatz zum spanischen Kolonialreich jede Form der Sklaverei abgeschafft hatte. Die Regierung in Mexiko-Stadt erfuhr davon erst durch einen Bericht des mexikanischen Konsuls in Havanna.
Teile von Ost-Yucatán blieben jedoch unter Kontrolle der Maya, die noch bis 1901 einen Guerillakrieg führten. 1858 zerstörten Maya-Rebellen die Stadt Bacalar, die bereits 1847–1849 unter Maya-Herrschaft gewesen war. Politisches und religiöses Zentrum der Maya wurde Chan Santa Cruz, wo die Maya-Kämpfer, die Cruzoob, den religiösen Ritus des Sprechenden Kreuzes praktizierten. Zwei Angriffe mexikanischer Truppen 1851 und 1860 auf Chan Santa Cruz wurden zurückgeschlagen. Ein zweites Kult-Zentrum mit Sprechendem Kreuz war Tulúm, das 1871 einen mexikanischen Angriff unter schweren Verlusten zurückschlagen musste.
Am 11. Januar 1884 unterzeichneten in Belize City ein General aus Chan Santa Cruz und der Vizegouverneur von Yucatán einen Vertrag, in dem die Maya die Souveränität Mexikos anerkannten und dafür Mexiko den Maya-Führer Crescencio Poot als Gouverneur des mexikanischen Bundesstaates Chan Santa Cruz akzeptierte. 1885 wurde Crescencio Poot jedoch von Gegnern aus Chan Santa Cruz ermordet, und diese setzten, inspiriert durch das Sprechende Kreuz, den Krieg fort.
Neben dem Staat Chan Santa Cruz mit über 30.000 Einwohnern, der von Tulum bis an die Grenze zu Britisch-Honduras reichte, gab es zwei weitere bedeutendere unabhängige Maya-Staaten: Die etwa 1000 Ixcanha-Maya, die weiterhin am traditionellen Katholizismus festhielten, und die Icaiche-Maya, welche auch Raubzüge nach Britisch-Honduras unternahmen. Beide Gruppen waren mit den Cruzoob verfeindet und schlossen gegen Ende des 19. Jahrhunderts Frieden mit den Mexikanern. 

Ein Grenzabkommen zwischen Mexiko und Großbritannien, dem damaligen Kolonialherren von Belize, im Jahre 1893 legte die Grundlage für die endgültige Unterwerfung der noch unabhängigen Maya. Die Briten verpflichteten sich, sämtlichen Handel (Waffen gegen Holz) mit den aufständischen Maya einzustellen. 1898 erfolgte die Gründung der mexikanischen Hafenstadt Payo Obispo (heute Chetumal). 1901 nahmen schließlich mexikanische Einheiten unter General Ignacio Bravo die bereits von den Cruzoob geräumte Maya-Stadt Chan Santa Cruz ein, zerstörten sie völlig und gründeten an ihrer Stelle die Stadt Santa Cruz de Bravo (benannt nach dem siegreichen General Bravo, seit 1930 Felipe Carrillo Puerto) und erschlossen sie über die 1905 in Betrieb genommene Decauville-Bahn Vigía Chico – Santa Cruz. Die Wälder wurden einigen Holzunternehmen zur Abholzung freigegeben. Das einstige Maya-Gebiet in Ost-Yucatán wurde noch 1902 als Territorium Quintana Roo (seit 1974 Bundesstaat) politisch vom Bundesstaat Yucatán getrennt und durch den von Porfirio Díaz ernannten Gouverneur General Bravo verwaltet.
Nach dem Sturz von Porfirio Díaz im Zuge der mexikanischen Revolution wurde General Bravo als Gouverneur des Territoriums Quintana Roo durch General Salvador Alvarado abgelöst, der den Auftrag hatte, die sozio-ökonomischen Ursachen des Krieges zu beseitigen und der den Kastenkrieg im September 1915 für beendet erklärte. In den 1920er Jahren wurden die 1901 geraubten Ländereien im Gebiet des einstigen Chan Santa Cruz an die Maya-Dorfgemeinden rückübertragen.
Dennoch kam es immer wieder zu Scharmützeln zwischen Cruzoob und Regierungstruppen. Die letzte Schlacht des über 85 Jahre dauernden Krieges fand im April 1933 statt, als bei der Stürmung des Dorfes Dzula durch die mexikanische Armee fünf Maya und zwei mexikanische Soldaten starben. Die letzten Cruzoob schlossen 1935 einen Friedensvertrag mit der mexikanischen Regierung, in dem sie die staatliche Autorität Mexikos anerkannten, ihre Dörfer aber weiterhin – bis zum heutigen Tag – selbst verwalten und den Kult des Sprechenden Kreuzes auf friedlicher Basis pflegen konnten.
Schätzungen über die Gesamtzahl der Todesopfer durch die unmittelbaren Einwirkungen des über lange Zeit sehr blutig geführten Kastenkriegs belaufen sich auf 40.000 bis 50.000 Menschen auf beiden Seiten.